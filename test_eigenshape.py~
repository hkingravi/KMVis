# this script tests the Eigenshape class
import numpy as np
import matplotlib as mp
import matplotlib.pyplot as plt
from scipy.io import loadmat, savemat
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.cm as cm

from time import time
from eigenshape import *

mat_file = loadmat('./data/yalefaces/yale_sub.mat',squeeze_me=False)
faces = np.transpose(mat_file['yale_sub_images'])
labels = np.asarray(mat_file['yale_sub_labels'])

print faces.shape
print labels.shape

start = time()
neigs = 20
es = Eigenshape(neigs)
es.process(faces)
eigenfaces = es.get("eigenshapes")

elapsed = (time() - start)
print "Elapsed time:", elapsed, "seconds"


# show some of the faces
width = 30
height = 40
indices = [0, 1, 2, 3, 4, 5, 6, 7]

# example images
fig_orig_img = plt.figure()
for i in indices:    
    img = faces[:,i]
    img = np.reshape(img, (width,height), order="F")
    plt.subplot(2, 4, i)
    imgplot = plt.imshow(np.float32(img))

# see eigenfaces
fig_efaces = plt.figure()
for i in indices:    
    eface = eigenfaces[:,i]
    eface = np.reshape(eface, (width,height), order="F")
    plt.subplot(2, 4, i)
    imgplot = plt.imshow(np.float32(eface))

plt.show()




